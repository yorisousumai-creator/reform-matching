<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¡ˆä»¶ç™»éŒ² - å†…éƒ¨ç®¡ç†</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: sans-serif;
      background-color: #f5f5f5;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h1 {
      margin-bottom: 30px;
      color: #333;
    }
    .form-group {
      margin-bottom: 20px;
    }
    label {
      display: block;
      font-weight: bold;
      margin-bottom: 8px;
      color: #555;
    }
    .required {
      color: red;
    }
    input, select, textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 15px;
    }
    textarea {
      resize: vertical;
      min-height: 100px;
    }
    button {
      background-color: #4caf50;
      color: #fff;
      padding: 15px 40px;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover {
      background-color: #43a047;
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    .message {
      padding: 15px;
      border-radius: 4px;
      margin-bottom: 20px;
      display: none;
    }
    .message.success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .message.error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“ æ¡ˆä»¶ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ </h1>
    
    <div id="message" class="message"></div>
    
    <form id="caseForm">
      <!-- é¡§å®¢æƒ…å ± -->
      <h2>é¡§å®¢æƒ…å ±</h2>
      
      <div class="form-group">
        <label>é¡§å®¢å <span class="required">*</span></label>
        <input type="text" name="customer_name" required>
      </div>
      
      <div class="form-group">
        <label>é›»è©±ç•ªå· </label>
        <input type="tel" name="customer_phone">
      </div>
      
      <div class="form-group">
        <label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
        <input type="email" name="customer_email">
      </div>
     
      <div class="form-group">
        <label>éƒµä¾¿ç•ªå·</label>
        <input type="text" name="postal_code" placeholder="ä¾‹ï¼š160-0022">
      </div>
      
      <div class="form-group">
        <label>éƒ½é“åºœçœŒ <span class="required">*</span></label>
        <input type="text" name="prefecture" required>
      </div>
      
      <div class="form-group">
        <label>å¸‚åŒºç”ºæ‘ <span class="required">*</span></label>
        <input type="text" name="city" required>
      </div>
      
      <div class="form-group">
        <label>ä½æ‰€ï¼ˆç•ªåœ°ä»¥é™ï¼‰</label>
        <input type="text" name="address">
      </div>
      
      <hr style="margin: 30px 0;">
      
      <!-- æ¡ˆä»¶æƒ…å ± -->
      <h2>æ¡ˆä»¶æƒ…å ±</h2>
      
      <div class="form-group">
        <label>ãƒªãƒ•ã‚©ãƒ¼ãƒ ç®‡æ‰€ <span class="required">*</span></label>
        <select name="reform_type" required>
          <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
          <option value="ã‚­ãƒƒãƒãƒ³">ã‚­ãƒƒãƒãƒ³</option>
          <option value="é¢¨å‘‚ãƒ»æµ´å®¤">é¢¨å‘‚ãƒ»æµ´å®¤</option>
          <option value="ãƒˆã‚¤ãƒ¬">ãƒˆã‚¤ãƒ¬</option>
          <option value="æ´—é¢æ‰€">æ´—é¢æ‰€</option>
          <option value="å¤–å£">å¤–å£</option>
          <option value="å±‹æ ¹">å±‹æ ¹</option>
          <option value="å†…è£…">å†…è£…</option>
          <option value="å…¨é¢ãƒªãƒ•ã‚©ãƒ¼ãƒ ">å…¨é¢ãƒªãƒ•ã‚©ãƒ¼ãƒ </option>
          <option value="ãã®ä»–">ãã®ä»–</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>äºˆç®—</label>
        <select name="budget_range">
          <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
          <option value="50ä¸‡å††æœªæº€">50ä¸‡å††æœªæº€</option>
          <option value="50-100ä¸‡å††">50ã€œ100ä¸‡å††</option>
          <option value="100-200ä¸‡å††">100ã€œ200ä¸‡å††</option>
          <option value="200-300ä¸‡å††">200ã€œ300ä¸‡å††</option>
          <option value="300-500ä¸‡å††">300ã€œ500ä¸‡å††</option>
          <option value="500ä¸‡å††ä»¥ä¸Š">500ä¸‡å††ä»¥ä¸Š</option>
          <option value="æœªå®š">æœªå®š</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>ç€å·¥å¸Œæœ›æ™‚æœŸ</label>
        <select name="desired_start_date">
          <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
          <option value="ã™ãã«ã§ã‚‚">ã™ãã«ã§ã‚‚</option>
          <option value="1ãƒ¶æœˆä»¥å†…">1ãƒ¶æœˆä»¥å†…</option>
          <option value="2-3ãƒ¶æœˆä»¥å†…">2ã€œ3ãƒ¶æœˆä»¥å†…</option>
          <option value="åŠå¹´ä»¥å†…">åŠå¹´ä»¥å†…</option>
          <option value="æœªå®š">æœªå®š</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>å„ªå…ˆåº¦</label>
        <select name="priority">
          <option value="é€šå¸¸">é€šå¸¸</option>
          <option value="é«˜">é«˜</option>
          <option value="è‡³æ€¥">è‡³æ€¥</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>è©³ç´°ãƒ»è¦æœ›</label>
        <textarea name="details"></textarea>
      </div>
      
      <div class="form-group">
        <label>Aç¤¾ã‹ã‚‰ã®ç‰¹è¨˜äº‹é …</label>
        <textarea name="contractor_notes" placeholder="Aç¤¾ã‹ã‚‰èã„ãŸç‰¹åˆ¥ãªæ³¨æ„äº‹é …ãªã©"></textarea>
      </div>
      
      <button type="submit" id="submitBtn">æ¡ˆä»¶ã‚’ç™»éŒ²</button>
    </form>
  </div>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm';
    
    const SUPABASE_URL = 'https://phkfsozxquabtzajmqwh.supabase.co';
    const SUPABASE_ANON_KEY = 'sb_publishable_238uos3NzkiGfsEliDrjdw_-qorclBl';
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    
    const form = document.getElementById('caseForm');
    const submitBtn = document.getElementById('submitBtn');
    const message = document.getElementById('message');
    
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      submitBtn.disabled = true;
      submitBtn.textContent = 'ç™»éŒ²ä¸­...';
      
      const formData = new FormData(form);
      const data = {
        customer_name: formData.get('customer_name'),
        customer_phone: formData.get('customer_phone'),
        customer_email: formData.get('customer_email') || null,
        postal_code: formData.get('postal_code'),
        prefecture: formData.get('prefecture'),
        city: formData.get('city'),
        address: formData.get('address') || null,
        reform_type: formData.get('reform_type'),
        budget_range: formData.get('budget_range') || null,
        desired_start_date: formData.get('desired_start_date') || null,
        details: formData.get('details') || null,
        priority: formData.get('priority') || 'é€šå¸¸',
        contractor_notes: formData.get('contractor_notes') || null,
        source: 'Aç¤¾æ¡ˆä»¶',
        status: 'æ–°è¦',
        is_serviceable: true
      };
      
      try {
        const { error } = await supabase
          .from('inquiries')
          .insert([data]);
        
        if (error) throw error;
        
        message.className = 'message success';
        message.textContent = 'âœ“ æ¡ˆä»¶ã‚’ç™»éŒ²ã—ã¾ã—ãŸ';
        message.style.display = 'block';
        
        form.reset();
        
        setTimeout(() => {
          message.style.display = 'none';
        }, 3000);
        
      } catch (error) {
        console.error('ã‚¨ãƒ©ãƒ¼:', error);
        message.className = 'message error';
        message.textContent = 'âœ— ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message;
        message.style.display = 'block';
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'æ¡ˆä»¶ã‚’ç™»éŒ²';
      }
    });
  </script>
</body>

</html>

